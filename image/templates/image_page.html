{% extends "base.html" %}
{% if user.is_authenticated %}
    {% block body %}
    <div id = "image_page">
        <h3>Image from user {{ image.user }}</h3>
        <img src="{{ MEDIA_URL }}{{ image.picture }}">
        <p>Source: {{ image.source }}</p>
        <p>Year: {{ image.year }}</p>
        <p>Image PK: {{ image.pk }}</p>
        {% if image.user = user %}
            <p><a href="{% url 'image:edit_image' image.pk %}">Edit</a></p>
        {% endif %}
        <div class = "prev">
        {% if not prev_image == -1 %}
            <a href="{% url 'image:image_page' prev_image %}" >prev {{ prev_image }} </a>
        {% else %}
            First Image
        {% endif %}
        </div>
        <div class = "next">
        {% if not next_image == -1 %}
            <a href="{% url 'image:image_page' next_image %}" >next {{ next_image }} </a>
        {% else %}
            Last Image
        {% endif %}
        {% load comments %}
        <h2>Comments for {{ object.title }}:</h2>
        {% get_comment_count for image as comment_count %}
        <p>{{ comment_count }} comments have been posted.</p>
        {% render_comment_list for image %}
        {% for comment in comment_list %}
            <p>Posted by: {{ comment.user_name }} on {{ comment.submit_date }}</p>
            <p>Comment: {{ comment.comment }}</p>
        {% endfor %}
        {% get_comment_form for image as form %}
        <!-- A context variable called form is created with the necessary hidden
        fields, timestamps and security hashes -->
        <table>
          <form action="{% comment_form_target %}" method="post">
            {% csrf_token %}
            {{ form }}
            <tr>
              <td colspan="2">
                <input type="submit" name="submit" value="Post">
                <input type="submit" name="preview" value="Preview">
              </td>
            </tr>
          </form>
        </table>
        </div>
    </div>
    {% endblock %}
{% endif %}